# Программное обеспечение для работы с COM портом в Windows

## Рекомендуемые программы для тестирования UART

### 1. PuTTY (Бесплатно, рекомендуется)

**Скачать:** https://www.putty.org/

**Использование:**
1. Запустите PuTTY
2. В разделе "Connection type" выберите **Serial**
3. В поле "Serial line" введите номер COM порта (например, `COM3`)
4. В поле "Speed" установите **115200**
5. Нажмите "Open"
6. В открывшемся окне вводите текст и нажимайте Enter для отправки

**Преимущества:**
- Бесплатная
- Простая в использовании
- Поддерживает различные скорости передачи
- Можно сохранять настройки

---

### 2. Tera Term (Бесплатно)

**Скачать:** https://ttssh2.osdn.jp/index.html.en

**Использование:**
1. Запустите Tera Term
2. Выберите **Serial** в диалоге подключения
3. Выберите COM порт из списка
4. Установите скорость **115200**
5. Нажмите OK
6. Вводите текст для отправки

**Преимущества:**
- Бесплатная
- Поддержка макросов
- Логирование сессии
- Поддержка различных протоколов

---

### 3. RealTerm (Бесплатно, для продвинутых пользователей)

**Скачать:** https://realterm.sourceforge.io/

**Использование:**
1. Запустите RealTerm
2. На вкладке "Port" выберите COM порт
3. Установите скорость **115200**
4. Нажмите "Open"
5. Перейдите на вкладку "Send"
6. Введите текст и нажмите "Send ASCII" или "Send Hex"

**Преимущества:**
- Бесплатная
- Множество функций для отладки
- Отправка данных в различных форматах (ASCII, Hex, Binary)
- Графическое отображение данных

---

### 4. Serial Port Monitor (Платно, пробная версия)

**Скачать:** https://www.eltima.com/products/serial-port-monitor/

**Использование:**
1. Запустите Serial Port Monitor
2. Выберите COM порт
3. Установите параметры (115200, 8, N, 1)
4. Начните мониторинг
5. Используйте функцию отправки данных

**Преимущества:**
- Профессиональные инструменты
- Расширенная диагностика
- Логирование и анализ данных

---

### 5. Arduino Serial Monitor (Если установлен Arduino IDE)

**Использование:**
1. Откройте Arduino IDE
2. Перейдите в Tools → Serial Monitor
3. Выберите COM порт в Tools → Port
4. Установите скорость **115200** в правом нижнем углу
5. Вводите текст в поле ввода и нажимайте Enter

**Преимущества:**
- Бесплатная (если уже установлен Arduino IDE)
- Простая в использовании
- Хорошо подходит для базового тестирования

---

### 6. CoolTerm (Бесплатно, кроссплатформенная)

**Скачать:** https://freeware.the-meiers.org/

**Использование:**
1. Запустите CoolTerm
2. Нажмите "Options"
3. Выберите COM порт
4. Установите скорость **115200**
5. Нажмите OK, затем "Connect"
6. Вводите текст для отправки

**Преимущества:**
- Бесплатная
- Кроссплатформенная (Windows, Mac, Linux)
- Простой интерфейс
- Поддержка различных форматов данных

---

## Определение номера COM порта в Windows

### Способ 1: Диспетчер устройств
1. Нажмите `Win + X` и выберите "Диспетчер устройств"
2. Разверните раздел "Порты (COM и LPT)"
3. Найдите ваш USB-UART преобразователь (например, "USB Serial Port (COM3)")

### Способ 2: Через командную строку
```cmd
mode
```
Или:
```cmd
wmic path Win32_SerialPort get DeviceID,Description
```

### Способ 3: Через PowerShell
```powershell
Get-WmiObject Win32_SerialPort | Select-Object Name,DeviceID
```

---

## Рекомендуемые настройки для тестирования ComToAir

**Параметры последовательного порта:**
- **Скорость (Baud Rate):** 115200
- **Биты данных:** 8
- **Четность:** None
- **Стоп-биты:** 1
- **Управление потоком:** None

**Сокращенно:** 115200, 8, N, 1

---

## Примеры тестовых команд

### Простой текст
```
Hello ComToAir
Test message 123
```

### С символами новой строки
```
Line 1
Line 2
Line 3
```

### Hex данные (в RealTerm)
```
48 65 6C 6C 6F 0D 0A
```
(Это "Hello\r\n" в hex)

### JSON данные
```
{"sensor":"temperature","value":25.5}
```

---

## Пошаговая инструкция для тестирования

### Используя PuTTY (рекомендуется):

1. **Подключите USB-UART преобразователь к компьютеру**
   - Убедитесь, что драйверы установлены
   - Запомните номер COM порта

2. **Запустите PuTTY**
   - Connection type: **Serial**
   - Serial line: **COM3** (ваш номер порта)
   - Speed: **115200**
   - Нажмите "Open"

3. **Отправьте тестовое сообщение**
   - Введите: `Hello ComToAir`
   - Нажмите Enter
   - Данные должны быть отправлены в ESP32

4. **Проверьте логи ESP32**
   - В мониторе последовательного порта PlatformIO должны появиться сообщения:
     - `*** RECEIVED X bytes ***`
     - `Text: Hello ComToAir`

5. **Проверьте веб-интерфейс**
   - Откройте `http://192.168.4.1/api/data`
   - Должны отображаться отправленные данные

---

## Устранение проблем

### COM порт не отображается
- Проверьте подключение USB-UART преобразователя
- Установите драйверы для PL2303TA
- Попробуйте другой USB порт

### Ошибка "Access Denied" или "Port is busy"
- Закройте другие программы, использующие COM порт
- Отключите монитор последовательного порта в PlatformIO
- Перезагрузите компьютер

### Данные не отправляются
- Проверьте скорость передачи (должна быть 115200)
- Убедитесь, что COM порт выбран правильно
- Проверьте подключение проводов (белый → A0, зеленый → A1)

### Данные отправляются, но ESP32 не получает
- Проверьте логи ESP32 через монитор последовательного порта
- Убедитесь, что провода подключены правильно
- Проверьте уровень RX пина в логах (должен меняться при отправке данных)

---

## Альтернативные методы тестирования

### Использование Python скрипта

Создайте файл `test_uart.py`:

```python
import serial
import time

# Настройки COM порта
COM_PORT = 'COM3'  # Замените на ваш COM порт
BAUD_RATE = 115200

try:
    # Открываем COM порт
    ser = serial.Serial(COM_PORT, BAUD_RATE, timeout=1)
    print(f"Подключено к {COM_PORT} на скорости {BAUD_RATE}")
    
    # Отправляем тестовое сообщение
    test_message = "Hello ComToAir\r\n"
    ser.write(test_message.encode())
    print(f"Отправлено: {test_message}")
    
    # Ждем немного
    time.sleep(0.1)
    
    # Читаем ответ (если есть)
    if ser.in_waiting > 0:
        response = ser.read(ser.in_waiting)
        print(f"Получено: {response.decode()}")
    
    # Закрываем порт
    ser.close()
    print("Порт закрыт")
    
except serial.SerialException as e:
    print(f"Ошибка: {e}")
except Exception as e:
    print(f"Неожиданная ошибка: {e}")
```

**Использование:**
1. Установите библиотеку: `pip install pyserial`
2. Измените `COM_PORT` на ваш номер порта
3. Запустите: `python test_uart.py`

---

## Рекомендация

Для быстрого тестирования рекомендуется использовать **PuTTY** - это самая простая и надежная программа для работы с COM портами в Windows.

Для более продвинутого тестирования с отправкой данных в различных форматах используйте **RealTerm**.

